batch_size = 2
hidden_size = 8

src = torch.rand(batch_size, hidden_size)
input_ = torch.zeros(batch_size+1, hidden_size)
index = torch.LongTensor([[0,1,2,0,0,1,1,2],[2,0,0,1,2,1,1,1]])

print('src\n',src)
print('index\n',index)
print('input_\n',input_)
print('ans:\n',input_.scatter_(0, index, src))
'''
src
 tensor([
        [0.3304, 0.5643, 0.2362, 0.1929, 0.2400, 0.6672, 0.5217, 0.4471],
        [0.0433, 0.2996, 0.9913, 0.4336, 0.8540, 0.8522, 0.0408, 0.1014]
        ]
        )
index
 tensor([
        [0, 1, 2, 0, 0, 1, 1, 2],
        [2, 0, 0, 1, 2, 1, 1, 1]
        ])
input_
 tensor([[0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0.],
        [0., 0., 0., 0., 0., 0., 0., 0.]])
ans:
 tensor([[0.3304, 0.2996, 0.9913, 0.1929, 0.2400, 0.0000, 0.0000, 0.0000],
        [0.0000, 0.5643, 0.0000, 0.4336, 0.0000, 0.8522, 0.0408, 0.1014],
        [0.0433, 0.0000, 0.2362, 0.0000, 0.8540, 0.0000, 0.0000, 0.4471]])
'''
